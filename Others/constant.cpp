#include "head.hpp"

// 阶乘
unsigned long long fact[21] = { // 0 ~ 20
1, 1, 2, 6, 24, 120, 720, 5040, 40320, 362880, 3628800, 39916800,
479001600, 6227020800, 87178291200, 1307674368000, 20922789888000, 355687428096000,
6402373705728000, 121645100408832000, 2432902008176640000ull
};
// 素数
int prime[1230] = { // 1 ~ 10000以内的素数（prime[i]为第i个素数）
0,2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,
191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,
397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,
617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,
857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997,1009,1013,1019,1021,1031,1033,1039,1049,1051,1061,1063,
1069,1087,1091,1093,1097,1103,1109,1117,1123,1129,1151,1153,1163,1171,1181,1187,1193,1201,1213,1217,1223,1229,1231,1237,1249,1259,1277,1279,
1283,1289,1291,1297,1301,1303,1307,1319,1321,1327,1361,1367,1373,1381,1399,1409,1423,1427,1429,1433,1439,1447,1451,1453,1459,1471,1481,1483,
1487,1489,1493,1499,1511,1523,1531,1543,1549,1553,1559,1567,1571,1579,1583,1597,1601,1607,1609,1613,1619,1621,1627,1637,1657,1663,1667,1669,
1693,1697,1699,1709,1721,1723,1733,1741,1747,1753,1759,1777,1783,1787,1789,1801,1811,1823,1831,1847,1861,1867,1871,1873,1877,1879,1889,1901,
1907,1913,1931,1933,1949,1951,1973,1979,1987,1993,1997,1999,2003,2011,2017,2027,2029,2039,2053,2063,2069,2081,2083,2087,2089,2099,2111,2113,
2129,2131,2137,2141,2143,2153,2161,2179,2203,2207,2213,2221,2237,2239,2243,2251,2267,2269,2273,2281,2287,2293,2297,2309,2311,2333,2339,2341,
2347,2351,2357,2371,2377,2381,2383,2389,2393,2399,2411,2417,2423,2437,2441,2447,2459,2467,2473,2477,2503,2521,2531,2539,2543,2549,2551,2557,
2579,2591,2593,2609,2617,2621,2633,2647,2657,2659,2663,2671,2677,2683,2687,2689,2693,2699,2707,2711,2713,2719,2729,2731,2741,2749,2753,2767,
2777,2789,2791,2797,2801,2803,2819,2833,2837,2843,2851,2857,2861,2879,2887,2897,2903,2909,2917,2927,2939,2953,2957,2963,2969,2971,2999,3001,
3011,3019,3023,3037,3041,3049,3061,3067,3079,3083,3089,3109,3119,3121,3137,3163,3167,3169,3181,3187,3191,3203,3209,3217,3221,3229,3251,3253,
3257,3259,3271,3299,3301,3307,3313,3319,3323,3329,3331,3343,3347,3359,3361,3371,3373,3389,3391,3407,3413,3433,3449,3457,3461,3463,3467,3469,
3491,3499,3511,3517,3527,3529,3533,3539,3541,3547,3557,3559,3571,3581,3583,3593,3607,3613,3617,3623,3631,3637,3643,3659,3671,3673,3677,3691,
3697,3701,3709,3719,3727,3733,3739,3761,3767,3769,3779,3793,3797,3803,3821,3823,3833,3847,3851,3853,3863,3877,3881,3889,3907,3911,3917,3919,
3923,3929,3931,3943,3947,3967,3989,4001,4003,4007,4013,4019,4021,4027,4049,4051,4057,4073,4079,4091,4093,4099,4111,4127,4129,4133,4139,4153,
4157,4159,4177,4201,4211,4217,4219,4229,4231,4241,4243,4253,4259,4261,4271,4273,4283,4289,4297,4327,4337,4339,4349,4357,4363,4373,4391,4397,
4409,4421,4423,4441,4447,4451,4457,4463,4481,4483,4493,4507,4513,4517,4519,4523,4547,4549,4561,4567,4583,4591,4597,4603,4621,4637,4639,4643,
4649,4651,4657,4663,4673,4679,4691,4703,4721,4723,4729,4733,4751,4759,4783,4787,4789,4793,4799,4801,4813,4817,4831,4861,4871,4877,4889,4903,
4909,4919,4931,4933,4937,4943,4951,4957,4967,4969,4973,4987,4993,4999,5003,5009,5011,5021,5023,5039,5051,5059,5077,5081,5087,5099,5101,5107,
5113,5119,5147,5153,5167,5171,5179,5189,5197,5209,5227,5231,5233,5237,5261,5273,5279,5281,5297,5303,5309,5323,5333,5347,5351,5381,5387,5393,
5399,5407,5413,5417,5419,5431,5437,5441,5443,5449,5471,5477,5479,5483,5501,5503,5507,5519,5521,5527,5531,5557,5563,5569,5573,5581,5591,5623,
5639,5641,5647,5651,5653,5657,5659,5669,5683,5689,5693,5701,5711,5717,5737,5741,5743,5749,5779,5783,5791,5801,5807,5813,5821,5827,5839,5843,
5849,5851,5857,5861,5867,5869,5879,5881,5897,5903,5923,5927,5939,5953,5981,5987,6007,6011,6029,6037,6043,6047,6053,6067,6073,6079,6089,6091,
6101,6113,6121,6131,6133,6143,6151,6163,6173,6197,6199,6203,6211,6217,6221,6229,6247,6257,6263,6269,6271,6277,6287,6299,6301,6311,6317,6323,
6329,6337,6343,6353,6359,6361,6367,6373,6379,6389,6397,6421,6427,6449,6451,6469,6473,6481,6491,6521,6529,6547,6551,6553,6563,6569,6571,6577,
6581,6599,6607,6619,6637,6653,6659,6661,6673,6679,6689,6691,6701,6703,6709,6719,6733,6737,6761,6763,6779,6781,6791,6793,6803,6823,6827,6829,
6833,6841,6857,6863,6869,6871,6883,6899,6907,6911,6917,6947,6949,6959,6961,6967,6971,6977,6983,6991,6997,7001,7013,7019,7027,7039,7043,7057,
7069,7079,7103,7109,7121,7127,7129,7151,7159,7177,7187,7193,7207,7211,7213,7219,7229,7237,7243,7247,7253,7283,7297,7307,7309,7321,7331,7333,
7349,7351,7369,7393,7411,7417,7433,7451,7457,7459,7477,7481,7487,7489,7499,7507,7517,7523,7529,7537,7541,7547,7549,7559,7561,7573,7577,7583,
7589,7591,7603,7607,7621,7639,7643,7649,7669,7673,7681,7687,7691,7699,7703,7717,7723,7727,7741,7753,7757,7759,7789,7793,7817,7823,7829,7841,
7853,7867,7873,7877,7879,7883,7901,7907,7919,7927,7933,7937,7949,7951,7963,7993,8009,8011,8017,8039,8053,8059,8069,8081,8087,8089,8093,8101,
8111,8117,8123,8147,8161,8167,8171,8179,8191,8209,8219,8221,8231,8233,8237,8243,8263,8269,8273,8287,8291,8293,8297,8311,8317,8329,8353,8363,
8369,8377,8387,8389,8419,8423,8429,8431,8443,8447,8461,8467,8501,8513,8521,8527,8537,8539,8543,8563,8573,8581,8597,8599,8609,8623,8627,8629,
8641,8647,8663,8669,8677,8681,8689,8693,8699,8707,8713,8719,8731,8737,8741,8747,8753,8761,8779,8783,8803,8807,8819,8821,8831,8837,8839,8849,
8861,8863,8867,8887,8893,8923,8929,8933,8941,8951,8963,8969,8971,8999,9001,9007,9011,9013,9029,9041,9043,9049,9059,9067,9091,9103,9109,9127,
9133,9137,9151,9157,9161,9173,9181,9187,9199,9203,9209,9221,9227,9239,9241,9257,9277,9281,9283,9293,9311,9319,9323,9337,9341,9343,9349,9371,
9377,9391,9397,9403,9413,9419,9421,9431,9433,9437,9439,9461,9463,9467,9473,9479,9491,9497,9511,9521,9533,9539,9547,9551,9587,9601,9613,9619,
9623,9629,9631,9643,9649,9661,9677,9679,9689,9697,9719,9721,9733,9739,9743,9749,9767,9769,9781,9787,9791,9803,9811,9817,9829,9833,9839,9851,
9857,9859,9871,9883,9887,9901,9907,9923,9929,9931,9941,9949,9967,9973
};
// 组合数
ull comb[68][34] = { // 最大到comb[67][33]：comb(67, 33)
{ 1 },
{ 1 },
{ 1,2 },
{ 1,3 },
{ 1,4,6 },
{ 1,5,10 },
{ 1,6,15,20 },
{ 1,7,21,35 },
{ 1,8,28,56,70 },
{ 1,9,36,84,126 },
{ 1,10,45,120,210,252 },
{ 1,11,55,165,330,462 },
{ 1,12,66,220,495,792,924 },
{ 1,13,78,286,715,1287,1716 },
{ 1,14,91,364,1001,2002,3003,3432 },
{ 1,15,105,455,1365,3003,5005,6435 },
{ 1,16,120,560,1820,4368,8008,11440,12870 },
{ 1,17,136,680,2380,6188,12376,19448,24310 },
{ 1,18,153,816,3060,8568,18564,31824,43758,48620 },
{ 1,19,171,969,3876,11628,27132,50388,75582,92378 },
{ 1,20,190,1140,4845,15504,38760,77520,125970,167960,184756 },
{ 1,21,210,1330,5985,20349,54264,116280,203490,293930,352716 },
{ 1,22,231,1540,7315,26334,74613,170544,319770,497420,646646,705432 },
{ 1,23,253,1771,8855,33649,100947,245157,490314,817190,1144066,1352078 },
{ 1,24,276,2024,10626,42504,134596,346104,735471,1307504,1961256,2496144,2704156 },
{ 1,25,300,2300,12650,53130,177100,480700,1081575,2042975,3268760,4457400,5200300 },
{ 1,26,325,2600,14950,65780,230230,657800,1562275,3124550,5311735,7726160,9657700,10400600 },
{ 1,27,351,2925,17550,80730,296010,888030,2220075,4686825,8436285,13037895,17383860,20058300 },
{ 1,28,378,3276,20475,98280,376740,1184040,3108105,6906900,13123110,21474180,30421755,37442160,40116600 },
{ 1,29,406,3654,23751,118755,475020,1560780,4292145,10015005,20030010,34597290,51895935,67863915,77558760 },
{ 1,30,435,4060,27405,142506,593775,2035800,5852925,14307150,30045015,54627300,86493225,119759850,145422675,155117520 },
{ 1,31,465,4495,31465,169911,736281,2629575,7888725,20160075,44352165,84672315,141120525,206253075,265182525,300540195 },
{ 1,32,496,4960,35960,201376,906192,3365856,10518300,28048800,64512240,129024480,225792840,347373600,471435600,565722720,601080390 },
{ 1,33,528,5456,40920,237336,1107568,4272048,13884156,38567100,92561040,193536720,354817320,573166440,818809200,1037158320,1166803110 },
{ 1,34,561,5984,46376,278256,1344904,5379616,18156204,52451256,131128140,286097760,548354040,927983760,1391975640,1855967520,2203961430,2333606220 },
{ 1,35,595,6545,52360,324632,1623160,6724520,23535820,70607460,183579396,417225900,834451800,1476337800,2319959400,3247943160,4059928950,4537567650 },
{ 1,36,630,7140,58905,376992,1947792,8347680,30260340,94143280,254186856,600805296,1251677700,2310789600,3796297200,5567902560,7307872110,8597496600,9075135300 },
{ 1,37,666,7770,66045,435897,2324784,10295472,38608020,124403620,348330136,854992152,1852482996,3562467300,6107086800,9364199760,12875774670,15905368710,17672631900 },
{ 1,38,703,8436,73815,501942,2760681,12620256,48903492,163011640,472733756,1203322288,2707475148,5414950296,9669554100,15471286560,22239974430,28781143380,33578000610,35345263800 },
{ 1,39,741,9139,82251,575757,3262623,15380937,61523748,211915132,635745396,1676056044,3910797436,8122425444,15084504396,25140840660,37711260990,51021117810,62359143990,68923264410 },
{ 1,40,780,9880,91390,658008,3838380,18643560,76904685,273438880,847660528,2311801440,5586853480,12033222880,23206929840,40225345056,62852101650,88732378800,113380261800,131282408400,137846528820 },
{ 1,41,820,10660,101270,749398,4496388,22481940,95548245,350343565,1121099408,3159461968,7898654920,17620076360,35240152720,63432274896,103077446706,151584480450,202112640600,244662670200,269128937220 },
{ 1,42,861,11480,111930,850668,5245786,26978328,118030185,445891810,1471442973,4280561376,11058116888,25518731280,52860229080,98672427616,166509721602,254661927156,353697121050,446775310800,513791607420,538257874440 },
{ 1,43,903,12341,123410,962598,6096454,32224114,145008513,563921995,1917334783,5752004349,15338678264,36576848168,78378960360,151532656696,265182149218,421171648758,608359048206,800472431850,960566918220,1052049481860 },
{ 1,44,946,13244,135751,1086008,7059052,38320568,177232627,708930508,2481256778,7669339132,21090682613,51915526432,114955808528,229911617056,416714805914,686353797976,1029530696964,1408831480056,1761039350070,2012616400080,2104098963720 },
{ 1,45,990,14190,148995,1221759,8145060,45379620,215553195,886163135,3190187286,10150595910,28760021745,73006209045,166871334960,344867425584,646626422970,1103068603890,1715884494940,2438362177020,3169870830126,3773655750150,4116715363800 },
{ 1,46,1035,15180,163185,1370754,9366819,53524680,260932815,1101716330,4076350421,13340783196,38910617655,101766230790,239877544005,511738760544,991493848554,1749695026860,2818953098830,4154246671960,5608233007146,6943526580276,7890371113950,8233430727600 },
{ 1,47,1081,16215,178365,1533939,10737573,62891499,314457495,1362649145,5178066751,17417133617,52251400851,140676848445,341643774795,751616304549,1503232609098,2741188875414,4568648125690,6973199770790,9762479679106,12551759587422,14833897694226,16123801841550 },
{ 1,48,1128,17296,194580,1712304,12271512,73629072,377348994,1677106640,6540715896,22595200368,69668534468,192928249296,482320623240,1093260079344,2254848913647,4244421484512,7309837001104,11541847896480,16735679449896,22314239266528,27385657281648,30957699535776,32247603683100 },
{ 1,49,1176,18424,211876,1906884,13983816,85900584,450978066,2054455634,8217822536,29135916264,92263734836,262596783764,675248872536,1575580702584,3348108992991,6499270398159,11554258485616,18851684897584,28277527346376,39049918716424,49699896548176,58343356817424,63205303218876 },
{ 1,50,1225,19600,230300,2118760,15890700,99884400,536878650,2505433700,10272278170,37353738800,121399651100,354860518600,937845656300,2250829575120,4923689695575,9847379391150,18053528883775,30405943383200,47129212243960,67327446062800,88749815264600,108043253365600,121548660036300,126410606437752 },
{ 1,51,1275,20825,249900,2349060,18009460,115775100,636763050,3042312350,12777711870,47626016970,158753389900,476260169700,1292706174900,3188675231420,7174519270695,14771069086725,27900908274925,48459472266975,77535155627160,114456658306760,156077261327400,196793068630200,229591913401900,247959266474052 },
{ 1,52,1326,22100,270725,2598960,20358520,133784560,752538150,3679075400,15820024220,60403728840,206379406870,635013559600,1768966344600,4481381406320,10363194502115,21945588357420,42671977361650,76360380541900,125994627894135,191991813933920,270533919634160,352870329957600,426384982032100,477551179875952,495918532948104 },
{ 1,53,1378,23426,292825,2869685,22957480,154143080,886322710,4431613550,19499099620,76223753060,266783135710,841392966470,2403979904200,6250347750920,14844575908435,32308782859535,64617565719070,119032357903550,202355008436035,317986441828055,462525733568080,623404249591760,779255311989700,903936161908052,973469712824056 },
{ 1,54,1431,24804,316251,3162510,25827165,177100560,1040465790,5317936260,23930713170,95722852680,343006888770,1108176102180,3245372870670,8654327655120,21094923659355,47153358767970,96926348578605,183649923622620,321387366339585,520341450264090,780512175396135,1085929983159840,1402659561581460,1683191473897752,1877405874732108,1946939425648112 },
{ 1,55,1485,26235,341055,3478761,28989675,202927725,1217566350,6358402050,29248649430,119653565850,438729741450,1451182990950,4353548972850,11899700525790,29749251314475,68248282427325,144079707346575,280576272201225,505037289962205,841728816603675,1300853625660225,1866442158555975,2488589544741300,3085851035479212,3560597348629860,3824345300380220 },
{ 1,56,1540,27720,367290,3819816,32468436,231917400,1420494075,7575968400,35607051480,148902215280,558383307300,1889912732400,5804731963800,16253249498640,41648951840265,97997533741800,212327989773900,424655979547800,785613562163430,1346766106565880,2142582442263900,3167295784216200,4355031703297275,5574440580220512,6646448384109072,7384942649010080,7648690600760440 },
{ 1,57,1596,29260,395010,4187106,36288252,264385836,1652411475,8996462475,43183019880,184509266760,707285522580,2448296039700,7694644696200,22057981462440,57902201338905,139646485582065,310325523515700,636983969321700,1210269541711230,2132379668729310,3489348548829780,5309878226480100,7522327487513475,9929472283517787,12220888964329584,14031391033119152,15033633249770520 },
{ 1,58,1653,30856,424270,4582116,40475358,300674088,1916797311,10648873950,52179482355,227692286640,891794789340,3155581562280,10142940735900,29752626158640,79960182801345,197548686920970,449972009097765,947309492837400,1847253511032930,3342649210440540,5621728217559090,8799226775309880,12832205713993575,17451799771031262,22150361247847371,26252279997448736,29065024282889672,30067266499541040 },
{ 1,59,1711,32509,455126,5006386,45057474,341149446,2217471399,12565671261,62828356305,279871768995,1119487075980,4047376351620,13298522298180,39895566894540,109712808959985,277508869722315,647520696018735,1397281501935165,2794563003870330,5189902721473470,8964377427999630,14420954992868970,21631432489303455,30284005485024837,39602161018878633,48402641245296107,55317304280338408,59132290782430712 },
{ 1,60,1770,34220,487635,5461512,50063860,386206920,2558620845,14783142660,75394027566,342700125300,1399358844975,5166863427600,17345898649800,53194089192720,149608375854525,387221678682300,925029565741050,2044802197953900,4191844505805495,7984465725343800,14154280149473100,23385332420868600,36052387482172425,51915437974328292,69886166503903470,88004802264174740,103719945525634515,114449595062769120,118264581564861424 },
{ 1,61,1830,35990,521855,5949147,55525372,436270780,2944827765,17341763505,90177170226,418094152866,1742058970275,6566222272575,22512762077400,70539987842520,202802465047245,536830054536825,1312251244423350,2969831763694950,6236646703759395,12176310231149295,22138745874816900,37539612570341700,59437719903041025,87967825456500717,121801604478231762,157890968768078210,191724747789809255,218169540588403635,232714176627630544 },
{ 1,62,1891,37820,557845,6471002,61474519,491796152,3381098545,20286591270,107518933731,508271323092,2160153123141,8308281242850,29078984349975,93052749919920,273342452889765,739632519584070,1849081298960175,4282083008118300,9206478467454345,18412956934908690,34315056105966195,59678358445158600,96977332473382725,147405545359541742,209769429934732479,279692573246309972,349615716557887465,409894288378212890,450883717216034179,465428353255261088 },
{ 1,63,1953,39711,595665,7028847,67945521,553270671,3872894697,23667689815,127805525001,615790256823,2668424446233,10468434365991,37387265592825,122131734269895,366395202809685,1012974972473835,2588713818544245,6131164307078475,13488561475572645,27619435402363035,52728013040874885,93993414551124795,156655690918541325,244382877832924467,357174975294274221,489462003181042451,629308289804197437,759510004936100355,860778005594247069,916312070471295267 },
{ 1,64,2016,41664,635376,7624512,74974368,621216192,4426165368,27540584512,151473214816,743595781824,3284214703056,13136858812224,47855699958816,159518999862720,488526937079580,1379370175283520,3601688791018080,8719878125622720,19619725782651120,41107996877935680,80347448443237920,146721427591999680,250649105469666120,401038568751465792,601557853127198688,846636978475316672,1118770292985239888,1388818294740297792,1620288010530347424,1777090076065542336,1832624140942590534 },
{ 1,65,2080,43680,677040,8259888,82598880,696190560,5047381560,31966749880,179013799328,895068996640,4027810484880,16421073515280,60992558771040,207374699821536,648045936942300,1867897112363100,4981058966301600,12321566916640800,28339603908273840,60727722660586800,121455445321173600,227068876035237600,397370533061665800,651687674221131912,1002596421878664480,1448194831602515360,1965407271460556560,2507588587725537680,3009106305270645216,3397378086595889760,3609714217008132870 },
{ 1,66,2145,45760,720720,8936928,90858768,778789440,5743572120,37014131440,210980549208,1074082795968,4922879481520,20448884000160,77413632286320,268367258592576,855420636763836,2515943049305400,6848956078664700,17302625882942400,40661170824914640,89067326568860640,182183167981760400,348524321356411200,624439409096903400,1049058207282797712,1654284096099796392,2450791253481179840,3413602103063071920,4472995859186094240,5516694892996182896,6406484391866534976,7007092303604022630,7219428434016265740 },
{ 1,67,2211,47905,766480,9657648,99795696,869648208,6522361560,42757703560,247994680648,1285063345176,5996962277488,25371763481680,97862516286480,345780890878896,1123787895356412,3371363686069236,9364899127970100,24151581961607100,57963796707857040,129728497393775280,271250494550621040,530707489338171600,972963730453314600,1673497616379701112,2703342303382594104,4105075349580976232,5864393356544251760,7886597962249166160,9989690752182277136ull,11923179284862717872ull,13413576695470557606ull,14226520737620288370ull }
};
// 斐波那契数
unsigned long long fib[94] = { // 最大到fib[93] 
0, 1, 1, 2, 3, 5, 8, 13, 21, 34, 55, 89, 144, 233, 377, 610, 987, 1597, 2584, 4181, 6765, 10946, 17711,
28657, 46368, 75025, 121393, 196418, 317811, 514229, 832040, 1346269, 2178309, 3524578, 5702887, 9227465,
14930352, 24157817, 39088169, 63245986, 102334155, 165580141, 267914296, 433494437, 701408733, 1134903170,
1836311903, 2971215073, 4807526976, 7778742049, 12586269025, 20365011074, 32951280099, 53316291173,
86267571272, 139583862445, 225851433717, 365435296162, 591286729879, 956722026041, 1548008755920,
2504730781961, 4052739537881, 6557470319842, 10610209857723, 17167680177565, 27777890035288, 44945570212853,
72723460248141, 117669030460994, 190392490709135, 308061521170129, 498454011879264, 806515533049393,
1304969544928657, 2111485077978050, 3416454622906707, 5527939700884757, 8944394323791464, 14472334024676221,
23416728348467685, 37889062373143906, 61305790721611591, 99194853094755497, 160500643816367088, 259695496911122585,
420196140727489673, 679891637638612258, 1100087778366101931, 1779979416004714189, 2880067194370816120,
4660046610375530309, 7540113804746346429, 12200160415121876738ull
};
// 康托展开
bool Cantor(int arr[], int n, bool vis[]) {
    int result = 0;
    for (int i = 0; i < n; i++) {
        int counted = 0;
        for (int j = i + 1; j < n; j++) {
            if (arr[i] > arr[j]) counted++;
        }
        result += counted * fact[n - i - 1];
    }
    return !vis[result] ? vis[result] = true, 1 : 0;
}